<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="reviewMapper">
	
	<!-- 리뷰 -->
	<resultMap type="Review" id="review_rm">
		<id property="reviewNo" column="REVIEW_NO"/>
		<result property="reviewPoint" column="REVIEW_POINT"/>
		<result property="reviewContent" column="REVIEW_CONTENT"/>
		<result property="reviewCreateDt" column="REVIEW_CREATE_DT"/>
		<result property="AttractionNo" column="ATTRACTION_NO"/>
		<result property="memberNo" column="MEMBER_NO"/>
		<result property="memberNick" column="MEMBER_NICK"/>
		<!-- 리뷰 이미지 첨부 -->
		<!-- <collection property="atList" column="REVIEW_NO" javaType="java.util.ArrayList" ofType="ReviewImage" select="selectImage"/> -->
	</resultMap>
	
	<!-- 페이지네이션 -->
	<resultMap type="ReviewPagination" id="pg_rm">
		<result property="listCount" column="CNT"/>
	</resultMap>
	
	<!-- 첨부 이미지 -->
	<resultMap type="ReviewImage" id="image_rm">
		<id property="fileNo" column="FILE_NO"/>
		<result property="fileNm" column="FILE_NM"/>
		<result property="filePath" column="FILE_PATH"/>
		<result property="reviewNo" column="REVIEW_NO"/>
	</resultMap>
	
	
	<!-- 명소별 전체 리뷰 수 조회 -->
	<select id="getListCount" parameterType="_int" resultMap="pg_rm">
		SELECT COUNT(*) CNT FROM REVIEW_LIST WHERE ATTRACTION_NO = #{attractionNo}
	</select>
	
	<select id="selectReviewList" parameterType="_int" resultMap="review_rm">
		SELECT * FROM REVIEW_LIST
		WHERE REVIEW_STATUS = 'Y'
		AND ATTRACTION_NO = #{attractionNo}
		ORDER BY REVIEW_NO DESC
	</select>  
	    
	
	 
</mapper>